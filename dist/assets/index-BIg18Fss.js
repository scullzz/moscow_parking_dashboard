import{r as d,j as e,B as S,i as j}from"./index-CkkKPyuP.js";import{m as O,n as P,T as N,a as p,C as H,b as M,c as B,e as R,f,g as U,o as V,P as K,p as $}from"./pagination-CzlqMKQ0.js";import{g as q,h as G,i as J,j as D}from"./index-C-92eTuZ.js";import{E as Q,A as W,a as X,b as Y,c as Z,d as _,e as ee,f as se,g as ae}from"./alert-dialog-CdkxFdne.js";import{a as v,t as C,L as w,I as k,z as m}from"./index-D2dM0BLR.js";import{D as A,a as T,b as E,c as F}from"./dialog-BlqGUlRA.js";import{I as te}from"./icons-Fc6yfTK3.js";import"./index-BpDdPLnr.js";const ne=m.object({key:m.string().min(1),name:m.string().min(1),description:m.string().min(1),value:m.string().min(1)});function ie({open:s,onOpenChange:a,setting:t,onUpdated:r}){const{register:i,handleSubmit:x,formState:{errors:l}}=v({resolver:C(ne),defaultValues:{key:t.key,name:t.name,description:t.description,value:t.value}}),[n,o]=d.useState(!1),b=async c=>{o(!0);try{const g=await O(t.id,c);r(g),j.success("Setting updated"),a(!1)}catch{j.error("Failed to update setting")}finally{o(!1)}};return e.jsx(A,{open:s,onOpenChange:a,children:e.jsxs(T,{children:[e.jsx(E,{children:e.jsx(F,{children:"Edit Setting"})}),e.jsxs("form",{onSubmit:x(b),className:"space-y-4 pt-2",children:[["key","name","description","value"].map(c=>{var g;return e.jsxs("div",{className:"space-y-1",children:[e.jsx(w,{className:"capitalize",children:c}),e.jsx(k,{...i(c)}),l[c]&&e.jsx("p",{className:"text-xs text-red-600",children:(g=l[c])==null?void 0:g.message})]},c)}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(S,{type:"button",variant:"outline",onClick:()=>a(!1),disabled:n,children:"Cancel"}),e.jsx(S,{type:"submit",disabled:n,children:n?"Saving…":"Save"})]})]})]})})}function le({setting:s,onDeleted:a,onUpdated:t}){const[r,i]=d.useState(!1),[x,l]=d.useState(!1),[n,o]=d.useState(!1),b=async()=>{o(!0);try{await P(s.id),a(s.id),j.success("Setting deleted"),i(!1)}catch{j.error("Failed to delete setting")}finally{o(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(q,{children:[e.jsx(G,{asChild:!0,children:e.jsx(S,{variant:"ghost",size:"icon",className:"h-8 w-8 p-0",children:e.jsx(Q,{className:"h-4 w-4"})})}),e.jsxs(J,{align:"end",className:"w-32",children:[e.jsx(D,{onSelect:()=>l(!0),children:"Edit"}),e.jsx(D,{className:"text-red-600 focus:text-red-600",onSelect:c=>{c.preventDefault(),i(!0)},children:"Delete"})]})]}),e.jsx(ie,{open:x,onOpenChange:l,setting:s,onUpdated:t}),e.jsx(W,{open:r,onOpenChange:i,children:e.jsxs(X,{children:[e.jsxs(Y,{children:[e.jsx(Z,{children:"Delete setting?"}),e.jsx(_,{children:"This action cannot be undone."})]}),e.jsxs(ee,{children:[e.jsx(se,{disabled:n,children:"Cancel"}),e.jsx(ae,{disabled:n,onClick:b,className:"bg-red-600 hover:bg-red-700",children:n?"Deleting…":"Delete"})]})]})})]})}function re({setting:s,onDelete:a,onUpdate:t}){return e.jsxs(N,{className:"transition-colors hover:bg-muted/50",children:[e.jsx(p,{children:s.id}),e.jsx(p,{children:s.key}),e.jsx(p,{children:s.name}),e.jsx(p,{children:s.description}),e.jsx(p,{children:s.value}),e.jsx(p,{className:"text-right",children:e.jsx(le,{setting:s,onDeleted:a,onUpdated:t})})]})}function ce({items:s,onDelete:a,onUpdate:t}){return e.jsx(H,{className:"rounded-2xl border border-muted bg-background shadow-lg",children:e.jsx(M,{className:"overflow-x-auto p-0",children:e.jsxs(B,{className:"min-w-full text-sm",children:[e.jsx(R,{children:e.jsxs(N,{className:"text-xs uppercase text-muted-foreground",children:[e.jsx(f,{className:"w-16",children:"ID"}),e.jsx(f,{className:"w-40",children:"Key"}),e.jsx(f,{className:"w-40",children:"Name"}),e.jsx(f,{children:"Description"}),e.jsx(f,{children:"Value"}),e.jsx(f,{className:"w-12 text-right"})]})}),e.jsx(U,{children:s.map(r=>e.jsx(re,{setting:r,onDelete:a,onUpdate:t},r.id))})]})})})}const de=m.object({key:m.string().min(1),name:m.string().min(1),description:m.string().min(1),value:m.string().min(1)});function oe({defaultValues:s,loading:a,onSubmit:t,onCancel:r}){const{register:i,handleSubmit:x,formState:{errors:l}}=v({resolver:C(de),defaultValues:s});return e.jsxs("form",{onSubmit:x(t),className:"space-y-4",children:[["key","name","description","value"].map(n=>{var o;return e.jsxs("div",{className:"space-y-1",children:[e.jsx(w,{className:"capitalize",children:n}),e.jsx(k,{...i(n)}),l[n]&&e.jsx("p",{className:"text-xs text-red-600",children:(o=l[n])==null?void 0:o.message})]},n)}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(S,{type:"button",variant:"outline",onClick:r,disabled:a,children:"Cancel"}),e.jsx(S,{type:"submit",disabled:a,children:a?"Saving…":"Save"})]})]})}function me({open:s,onOpenChange:a,onCreated:t}){const[r,i]=d.useState(!1),x=async l=>{i(!0);try{const n=await V(l);t(n),j.success("Setting created"),a(!1)}catch{j.error("Failed to create setting")}finally{i(!1)}};return e.jsx(A,{open:s,onOpenChange:a,children:e.jsxs(T,{children:[e.jsx(E,{children:e.jsx(F,{children:"New Setting"})}),e.jsx(oe,{defaultValues:{key:"",name:"",description:"",value:""},loading:r,onSubmit:x,onCancel:()=>a(!1)})]})})}function be(){const[s,a]=d.useState(1),t=50,[r,i]=d.useState([]),[x,l]=d.useState(!1),[n,o]=d.useState(1),[b,c]=d.useState(!0),g=async(u=s)=>{c(!0);try{const h=await $(u,t);i(h.items),o(h.pages)}catch{j.error("Cannot load settings")}finally{c(!1)}};d.useEffect(()=>void g(s),[s]);const I=u=>i(h=>h.filter(y=>y.id!==u)),L=u=>i(h=>h.map(y=>y.id===u.id?u:y)),z=u=>i(h=>[u,...h]);return e.jsxs("main",{className:"container mx-auto space-y-6 p-6",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs(S,{onClick:()=>l(!0),children:[e.jsx(te.add,{className:"mr-2 h-4 w-4"}),"Add Setting"]})}),b?e.jsx("p",{className:"text-center",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{items:r,onDelete:I,onUpdate:L}),e.jsx(K,{current:s,total:n,size:t,onChange:a})]}),e.jsx(me,{open:x,onOpenChange:l,onCreated:z})]})}export{be as default};
