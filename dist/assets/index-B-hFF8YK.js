import{j as e,B as y,r as n,i as u}from"./index-CkkKPyuP.js";import{I as w}from"./icons-Fc6yfTK3.js";import{s as le,t as re,T as p,a as i,C as v,b as O,c as C,e as T,f as l,g as A,v as ce,P,w as de,x as oe,y as xe}from"./pagination-CzlqMKQ0.js";import{g as me,h as he,i as je,j as z}from"./index-C-92eTuZ.js";import{a as ue,L as D,I as F,z as f,t as ge}from"./index-D2dM0BLR.js";import{D as H,a as I,b as M,c as R}from"./dialog-BlqGUlRA.js";import{E as pe,A as fe,a as Ne,b as be,c as we,d as ye,e as ke,f as Se,g as Pe}from"./alert-dialog-CdkxFdne.js";import{f as U}from"./format-cwXK75ha.js";import"./index-BpDdPLnr.js";const De=f.object({zone_id:f.string().min(1),name:f.string().min(1),rate:f.coerce.number().nonnegative(),availability:f.boolean()});function B({defaultValues:a,loading:t,onSubmit:s,onCancel:c}){const{register:o,handleSubmit:j,formState:{errors:x}}=ue({resolver:ge(De),defaultValues:a});return e.jsxs("form",{onSubmit:j(s),className:"space-y-4",children:[["zone_id","name"].map(r=>{var m;return e.jsxs("div",{className:"space-y-1",children:[e.jsx(D,{className:"capitalize",children:r.replace("_"," ")}),e.jsx(F,{...o(r)}),x[r]&&e.jsx("p",{className:"text-xs text-red-600",children:(m=x[r])==null?void 0:m.message})]},r)}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{children:"Rate"}),e.jsx(F,{type:"number",...o("rate")})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-5",children:[e.jsx("input",{type:"checkbox",...o("availability")}),e.jsx(D,{children:"Available"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(y,{type:"button",variant:"outline",onClick:c,disabled:t,children:"Cancel"}),e.jsx(y,{type:"submit",disabled:t,children:t?"Saving…":"Save"})]})]})}function ve({open:a,onOpenChange:t,option:s,onUpdated:c}){const[o,j]=n.useState(!1),x=async r=>{j(!0);try{const m=await le(s.id,r);c(m),u.success("Option updated"),t(!1)}catch{u.error("Failed to update option")}finally{j(!1)}};return e.jsx(H,{open:a,onOpenChange:t,children:e.jsxs(I,{children:[e.jsx(M,{children:e.jsx(R,{children:"Edit Parking Option"})}),e.jsx(B,{defaultValues:{zone_id:s.zone_id,name:s.name,rate:s.rate,availability:s.availability},loading:o,onSubmit:x,onCancel:()=>t(!1)})]})})}function Oe({option:a,onDeleted:t,onUpdated:s}){const[c,o]=n.useState(!1),[j,x]=n.useState(!1),[r,m]=n.useState(!1),k=async()=>{m(!0);try{await re(a.id),t(a.id),u.success("Option deleted"),x(!1)}catch{u.error("Failed to delete option")}finally{m(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(me,{children:[e.jsx(he,{asChild:!0,children:e.jsx(y,{variant:"ghost",size:"icon",className:"h-8 w-8 p-0",children:e.jsx(pe,{className:"h-4 w-4"})})}),e.jsxs(je,{align:"end",className:"w-32",children:[e.jsx(z,{onSelect:()=>o(!0),children:"Edit"}),e.jsx(z,{className:"text-red-600 focus:text-red-600",onSelect:S=>{S.preventDefault(),x(!0)},children:"Delete"})]})]}),e.jsx(ve,{open:c,onOpenChange:o,option:a,onUpdated:s}),e.jsx(fe,{open:j,onOpenChange:x,children:e.jsxs(Ne,{children:[e.jsxs(be,{children:[e.jsx(we,{children:"Delete option?"}),e.jsx(ye,{children:"This action cannot be undone."})]}),e.jsxs(ke,{children:[e.jsx(Se,{disabled:r,children:"Cancel"}),e.jsx(Pe,{disabled:r,onClick:k,className:"bg-red-600 hover:bg-red-700",children:r?"Deleting…":"Delete"})]})]})})]})}function Ce({option:a,onDelete:t,onUpdate:s}){return e.jsxs(p,{className:"hover:bg-muted/50",children:[e.jsx(i,{children:a.id}),e.jsx(i,{children:a.zone_id}),e.jsx(i,{children:a.name}),e.jsx(i,{className:"text-right",children:a.rate}),e.jsx(i,{children:a.availability?"✔":"✖"}),e.jsx(i,{className:"text-right",children:e.jsx(Oe,{option:a,onDeleted:t,onUpdated:s})})]})}function Te({items:a,onDelete:t,onUpdate:s}){return e.jsx(v,{className:"rounded-2xl border border-muted bg-background shadow-lg",children:e.jsx(O,{className:"overflow-x-auto p-0",children:e.jsxs(C,{className:"min-w-full text-sm",children:[e.jsx(T,{children:e.jsxs(p,{className:"text-xs uppercase text-muted-foreground",children:[e.jsx(l,{className:"w-16",children:"ID"}),e.jsx(l,{className:"w-40",children:"Zone"}),e.jsx(l,{children:"Name"}),e.jsx(l,{className:"w-24 text-right",children:"Rate"}),e.jsx(l,{className:"w-24",children:"Avail."}),e.jsx(l,{className:"w-12 text-right"})]})}),e.jsx(A,{children:a.map(c=>e.jsx(Ce,{option:c,onDelete:t,onUpdate:s},c.id))})]})})})}function Ae({items:a}){const t=s=>U(new Date(s),"yyyy-MM-dd HH:mm");return e.jsx(v,{className:"rounded-2xl border-muted shadow-lg",children:e.jsx(O,{className:"overflow-x-auto p-0",children:e.jsxs(C,{className:"min-w-full text-sm",children:[e.jsx(T,{children:e.jsxs(p,{className:"text-xs uppercase text-muted-foreground",children:[e.jsx(l,{className:"w-16",children:"ID"}),e.jsx(l,{className:"w-24",children:"User"}),e.jsx(l,{className:"w-32",children:"Action"}),e.jsx(l,{children:"Parameters"}),e.jsx(l,{className:"w-24",children:"Status"}),e.jsx(l,{className:"w-48",children:"Created"})]})}),e.jsx(A,{children:a.map(s=>e.jsxs(p,{className:"hover:bg-muted/50",children:[e.jsx(i,{children:s.id}),e.jsx(i,{children:s.user_id}),e.jsx(i,{children:s.action_type}),e.jsx(i,{children:s.parameters}),e.jsx(i,{children:s.status}),e.jsx(i,{children:t(s.created_at)})]},s.id))})]})})})}function _e({open:a,onOpenChange:t,onCreated:s}){const[c,o]=n.useState(!1),j=async x=>{o(!0);try{const r=await ce(x);s(r),u.success("Option created"),t(!1)}catch{u.error("Failed to create option")}finally{o(!1)}};return e.jsx(H,{open:a,onOpenChange:t,children:e.jsxs(I,{children:[e.jsx(M,{children:e.jsx(R,{children:"New Parking Option"})}),e.jsx(B,{defaultValues:{zone_id:"",name:"",rate:0,availability:!0},loading:c,onSubmit:j,onCancel:()=>t(!1)})]})})}function Ee({items:a}){const t=s=>U(new Date(s),"yyyy-MM-dd HH:mm");return e.jsx(v,{className:"rounded-2xl border-muted shadow-lg",children:e.jsx(O,{className:"overflow-x-auto p-0",children:e.jsxs(C,{className:"min-w-full text-sm",children:[e.jsx(T,{children:e.jsxs(p,{className:"text-xs uppercase text-muted-foreground",children:[e.jsx(l,{className:"w-16",children:"ID"}),e.jsx(l,{className:"w-24",children:"User"}),e.jsx(l,{className:"w-24",children:"Vehicle"}),e.jsx(l,{className:"w-24",children:"Option"}),e.jsx(l,{className:"w-48",children:"Start"}),e.jsx(l,{className:"w-48",children:"End"}),e.jsx(l,{className:"w-24",children:"Type"}),e.jsx(l,{className:"w-24",children:"Status"})]})}),e.jsx(A,{children:a.map(s=>e.jsxs(p,{className:"hover:bg-muted/50",children:[e.jsx(i,{children:s.id}),e.jsx(i,{children:s.user_id}),e.jsx(i,{children:s.vehicle_id}),e.jsx(i,{children:s.option_id}),e.jsx(i,{children:t(s.start_time)}),e.jsx(i,{children:t(s.end_time)}),e.jsx(i,{children:s.type}),e.jsx(i,{children:s.status})]},s.id))})]})})})}function Ve(){const[a,t]=n.useState(1),[s,c]=n.useState([]),[o,j]=n.useState(1),[x,r]=n.useState(!0),[m,k]=n.useState(1),[S,V]=n.useState([]),[Z,q]=n.useState(1),[G,_]=n.useState(!0),[N,J]=n.useState(1),[K,Q]=n.useState([]),[W,X]=n.useState(1),[Y,E]=n.useState(!0),g=50,$=async(h=a)=>{r(!0);try{const d=await de(h,g);c(d.items),j(d.pages)}catch{u.error("Cannot load options")}finally{r(!1)}},ee=async(h=m)=>{_(!0);try{const d=await oe(h,g);V(d.items),q(d.pages)}catch{u.error("Cannot load sessions")}finally{_(!1)}},se=async(h=N)=>{E(!0);try{const d=await xe(h,g);Q(d.items),X(d.pages)}catch{u.error("Cannot load tasks")}finally{E(!1)}};n.useEffect(()=>void $(a),[a]),n.useEffect(()=>void ee(m),[m]),n.useEffect(()=>void se(N),[N]);const[ae,L]=n.useState(!1),te=h=>c(d=>[h,...d]),ne=h=>c(d=>d.filter(b=>b.id!==h)),ie=h=>c(d=>d.map(b=>b.id===h.id?h:b));return e.jsxs("main",{className:"container mx-auto space-y-12 p-6",children:[e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(w.parking,{className:"h-5 w-5"}),"Parking options"]}),e.jsxs(y,{onClick:()=>L(!0),children:[e.jsx(w.add,{className:"mr-2 h-4 w-4"}),"Add Option"]})]}),x?e.jsx("p",{className:"text-center",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsx(Te,{items:s,onDelete:ne,onUpdate:ie}),e.jsx(P,{current:a,total:o,size:g,onChange:t})]})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(w.session,{className:"h-5 w-5"}),"Parking sessions"]}),G?e.jsx("p",{className:"text-center",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsx(Ee,{items:S}),e.jsx(P,{current:m,total:Z,size:g,onChange:k})]})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(w.task,{className:"h-5 w-5"}),"Parking tasks"]}),Y?e.jsx("p",{className:"text-center",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsx(Ae,{items:K}),e.jsx(P,{current:N,total:W,size:g,onChange:J})]})]}),e.jsx(_e,{open:ae,onOpenChange:L,onCreated:te})]})}export{Ve as default};
